<div class="container">

 <button
    class="btn btn-secondary btn-floating"
    style="position: fixed; top: 20px; right: 20px; z-index: 1000;"
    (click)="volverAlDashboard()"
    title="Volver al Dashboard"
  >
    <i class="bi bi-house-door-fill"></i> Dashboard
  </button>

  @if (empresas.length > 0) {
    <h6>Empresas Asociadas</h6>
    <div class="row g-3 mb-4">
      @for (empresa of empresas; track empresa.id) {
        <div class="col-12 col-md-6 col-lg-4">
          <div class="card p-3 h-100">
            <div class="row align-items-center">
              <div class="col-auto">
                @if (empresa.logoUrl) {
                  <img [src]="empresa.logoUrl" alt="Logo" style="max-width: 80px; max-height: 80px; border-radius: 8px;">
                }
              </div>
              <div class="col">
                <p><strong>Nombre:</strong> {{ empresa.name }}</p>
                <p><strong>Teléfono:</strong> {{ empresa.phone }}</p>
                <p><strong>Email:</strong> {{ empresa.email }}</p>
                <p><strong>Descripción:</strong> {{ empresa.description }}</p>
              </div>
            </div>
          </div>
        </div>
      }
    </div>
  }
  <div *ngIf="clientes.length > 0" class="mb-4">
    <h6>Clientes Asociados</h6>
    <div class="table-responsive">
      <table class="table table-bordered table-hover table-sm">
        <thead class="table-light">
          <tr>
            <th>Nombre</th>
            <th>Contacto</th>
            <th>Email</th>
            <th>CUIT/Clave</th>
            <th>Dirección</th>
            <th>Fecha Presupuesto</th>
            <th>Detalles</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let cliente of clientes">
            <td>{{ cliente.name }}</td>
            <td>{{ cliente.contact }}</td>
            <td>{{ cliente.email }}</td>
            <td>{{ cliente.clave }}</td>
            <td>{{ cliente.direccion }}</td>
            <td>{{ cliente.budgetDate }}</td>
            <td>{{ cliente.additionalDetails }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
  <div *ngIf="userData" class="user-info mb-3">
    <h6>Datos del Usuario</h6>
    <p><strong>Email:</strong> {{ userData.email }}</p>
    <p><strong>Teléfono:</strong> {{ userData.telefono || '-' }}</p>
    <p><strong>Provincia:</strong> {{ userData.provincia || '-' }}</p>
    <p><strong>País:</strong> {{ userData.pais || '-' }}</p>
  </div>

  <h5 class="text-primary">PRESUPUESTO</h5>
  <div class="table-responsive">
    <table class="table table-striped table-bordered table-hover table-sm">
      <thead class="thead-light">
        <tr>
          <th class="text-center">Tarea</th>
          <th class="text-center">Rubro</th>
          <th class="text-center">Categoría</th>
          <th class="text-center">Descripción</th>
          <th class="text-center">Área (m²/m³)</th>
          <th class="text-center">Costo</th>
          <th class="text-center">Total</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let tarea of tareasAgregadas">
          <td>{{ tarea.tarea }}</td>
          <td>{{ tarea.rubro || '-' }}</td>
          <td>{{ tarea.categoria || '-' }}</td>
          <td>{{ tarea.descripcion }}</td>
          <td>{{ tarea.area | number:'1.2-2' }}</td>
          <td>{{ tarea.costo | currency:'USD':'symbol':'1.2-2' }}</td>
          <td>{{ tarea.totalCost | currency:'USD':'symbol':'1.2-2' }}</td>
        </tr>
      </tbody>
    </table>
  </div>
  <div class="mt-3" style="font-size: 22px; padding: 8px; margin-bottom: 20px; background-color: white; box-shadow: rgba(50, 50, 105, 0.15) 0px 2px 5px 0px, rgba(0, 0, 0, 0.05) 0px 1px 1px 0px;">
    Total: {{ calcularCostoTotal() | currency:'USD':'symbol':'1.2-2' }}
  </div>
</div>
